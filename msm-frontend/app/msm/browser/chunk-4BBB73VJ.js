import{c as p,i as h,la as l,m as i,o as n}from"./chunk-J3ZMDLLJ.js";var c=class extends Error{};c.prototype.name="InvalidTokenError";function v(e){return decodeURIComponent(atob(e).replace(/(.)/g,(t,a)=>{let r=a.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}function j(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return v(t)}catch{return atob(t)}}function m(e,t){if(typeof e!="string")throw new c("Invalid token specified: must be a string");t||(t={});let a=t.header===!0?0:1,r=e.split(".")[a];if(typeof r!="string")throw new c(`Invalid token specified: missing part #${a+1}`);let o;try{o=j(r)}catch(s){throw new c(`Invalid token specified: invalid base64 for part #${a+1} (${s.message})`)}try{return JSON.parse(o)}catch(s){throw new c(`Invalid token specified: invalid json for part #${a+1} (${s.message})`)}}var u=(()=>{let t=class t{constructor(){}getAuthToken(){return localStorage.getItem("auth_token")}getDecodedAuthToken(){let r=localStorage.getItem("auth_token");return r?m(r):null}setAuthToken(r){localStorage.setItem("auth_token",r)}removeAuthToken(){localStorage.removeItem("auth_token")}currentUsername(){return this.getDecodedAuthToken()?.name}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=i({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var S=(()=>{let t=class t{constructor(r){this.localStorage=r}intercept(r,o){let s=this.localStorage.getAuthToken();return s&&(r=r.clone({setHeaders:{Authorization:`Bearer ${s}`}})),o.handle(r)}};t.\u0275fac=function(o){return new(o||t)(n(u))},t.\u0275prov=i({token:t,factory:t.\u0275fac});let e=t;return e})();var T=(()=>{let t=class t{constructor(){}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=i({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var g=(()=>{let t=class t{constructor(r,o){this.localStorage=r,this.router=o}isUserAuthenticated(){return!!this.localStorage.getAuthToken()}logout(){this.localStorage.removeAuthToken(),this.router.navigate(["/auth/login"])}};t.\u0275fac=function(o){return new(o||t)(n(u),n(l))},t.\u0275prov=i({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var b=(()=>{let t=class t{constructor(){this.spinnerSubject=new p(!1),this.spinnerState=this.spinnerSubject.asObservable()}show(){this.spinnerSubject.next(!0)}hide(){this.spinnerSubject.next(!1)}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=i({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var O=(()=>{let t=class t{constructor(r){this.spinnerService=r}intercept(r,o){return this.spinnerService.show(),o.handle(r).pipe(h(()=>{this.spinnerService.hide()}))}};t.\u0275fac=function(o){return new(o||t)(n(b))},t.\u0275prov=i({token:t,factory:t.\u0275fac});let e=t;return e})();var K=(()=>{let t=class t{constructor(r,o){this.auth=r,this.router=o}canActivate(){return this.auth.isUserAuthenticated()?!0:(this.router.navigate(["/auth/login"]),!1)}};t.\u0275fac=function(o){return new(o||t)(n(g),n(l))},t.\u0275prov=i({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();export{b as a,u as b,T as c,g as d,S as e,O as f,K as g};
